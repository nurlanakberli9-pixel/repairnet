<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>T…ômirNet - Usta Tap</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .hero-section { background: #0d6efd; color: white; padding: 50px 0; }
        .shop-card { border: none; border-radius: 12px; transition: 0.3s; }
        .shop-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand fw-bold" href="#">T…ômirNet</a>
        <div class="ms-auto">
            <span id="welcomeMsg" class="text-light me-3 small"></span>
            <a href="create-shop.html" class="btn btn-warning btn-sm fw-bold">D√ºkanƒ±nƒ± Yarat (Usta Profili)</a>
        </div>
    </div>
</nav>

<div class="hero-section text-center">
    <div class="container">
        <h1>∆èn Yax≈üƒ± Ustalarƒ± Tap</h1>
        <p class="lead">Brend v…ô xidm…ôt…ô g√∂r…ô s√ºr…ôtli axtarƒ±≈ü</p>
    </div>
</div>

<div class="container mt-n4" style="margin-top: -30px;">
    <div class="card p-4 shadow">
        <div class="row g-3">
            <div class="col-md-4">
                <input type="text" id="brandInput" class="form-control" placeholder="Brend (m…ôs: Apple)">
            </div>
            <div class="col-md-4">
                <input type="text" id="serviceInput" class="form-control" placeholder="Xidm…ôt (m…ôs: Ekran t…ômiri)">
            </div>
            <div class="col-md-4">
                <button onclick="searchShops()" class="btn btn-primary w-100 fw-bold">Axtar</button>
            </div>
        </div>
    </div>

    <div class="row mt-5" id="resultsContainer">
    </div>
</div>

<script>
    // Qeydiyyatdan ke√ß…ôn istifad…ô√ßini salamla
    const user = localStorage.getItem('currentUser');
    if(user) document.getElementById('welcomeMsg').innerText = "Salam, " + user;

    async function searchShops() {
        const brand = document.getElementById('brandInput').value;
        const service = document.getElementById('serviceInput').value;
        const container = document.getElementById('resultsContainer');

        let url = `http://localhost:8080/RepairShop/search?size=10&`;
        if(brand) url += `brand=${encodeURIComponent(brand)}&`;
        if(service) url += `service=${encodeURIComponent(service)}&`;

        try {
            const response = await fetch(url);
            const data = await response.json();
            const shops = data.content;

            container.innerHTML = '';
            if (shops.length === 0) {
                container.innerHTML = '<p class="text-center">He√ß bir usta tapƒ±lmadƒ±.</p>';
                return;
            }

            shops.forEach(shop => {
                const card = `
                    <div class="col-md-4 mb-4">
                        <div class="card shop-card shadow-sm h-100 p-3">
                            <h5 class="text-primary">${shop.name}</h5>
                            <p class="small mb-1">üìç ${shop.address}</p>
                            <p class="small">üìû ${shop.phoneNumber}</p>
                            <hr>
                            <h6>Qiym…ôtl…ôr:</h6>
                            <ul class="list-unstyled small">
                                ${shop.offers.map(o => `<li>‚úÖ ${o.brandName} - ${o.serviceTypeName}: <b>${o.price} AZN</b></li>`).join('')}
                            </ul>
                        </div>
                    </div>`;
                container.insertAdjacentHTML('beforeend', card);
            });
        } catch (e) { alert("X…ôta ba≈ü verdi!"); }
    }
</script>
</body>
</html>